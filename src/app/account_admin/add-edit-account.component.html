<div class="d-flex justify-content-between align-items-center mb-4">
  <h5 class="mb-0">{{ title }}</h5>
  <button type="button" class="btn btn-outline-secondary" (click)="cancel()">
    <i class="bi bi-arrow-left me-2"></i>Back to List
  </button>
</div>

<div *ngIf="loading" class="text-center">
  <div class="spinner-border" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>

<form *ngIf="!loading" [formGroup]="form" (ngSubmit)="onSubmit()">
  <div class="row">
    <div class="col-md-6">
      <div class="mb-3">
        <label for="firstName" class="form-label">First Name *</label>
        <input
          type="text"
          id="firstName"
          formControlName="firstName"
          class="form-control"
          [class.is-invalid]="submitted && f['firstName'].errors"
        />
        <div *ngIf="submitted && f['firstName'].errors" class="invalid-feedback">
          <div *ngIf="f['firstName'].errors?.['required']">First Name is required</div>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="mb-3">
        <label for="lastName" class="form-label">Last Name *</label>
        <input
          type="text"
          id="lastName"
          formControlName="lastName"
          class="form-control"
          [class.is-invalid]="submitted && f['lastName'].errors"
        />
        <div *ngIf="submitted && f['lastName'].errors" class="invalid-feedback">
          <div *ngIf="f['lastName'].errors?.['required']">Last Name is required</div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div class="mb-3">
        <label for="email" class="form-label">Email *</label>
        <input
          type="email"
          id="email"
          formControlName="email"
          class="form-control"
          [class.is-invalid]="submitted && f['email'].errors"
        />
        <div *ngIf="submitted && f['email'].errors" class="invalid-feedback">
          <div *ngIf="f['email'].errors?.['required']">Email is required</div>
          <div *ngIf="f['email'].errors?.['email']">Email must be a valid email address</div>
        </div>
      </div>
    </div>
    
    <div class="col-md-6">
      <div class="mb-3">
        <label for="role" class="form-label">Role *</label>
        <select
          id="role"
          formControlName="role"
          class="form-select"
          [class.is-invalid]="submitted && f['role'].errors"
        >
          <option value="">Select Role</option>
          <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
        </select>
        <div *ngIf="submitted && f['role'].errors" class="invalid-feedback">
          <div *ngIf="f['role'].errors?.['required']">Role is required</div>
        </div>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="!id">
    <div class="col-md-6">
      <div class="mb-3">
        <label for="password" class="form-label">Password *</label>
        <input
          type="password"
          id="password"
          formControlName="password"
          class="form-control"
          [class.is-invalid]="submitted && f['password'].errors"
        />
        <div *ngIf="submitted && f['password'].errors" class="invalid-feedback">
          <div *ngIf="f['password'].errors?.['required']">Password is required</div>
          <div *ngIf="f['password'].errors?.['minlength']">Password must be at least 6 characters</div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="mb-3">
        <label for="confirmPassword" class="form-label">Confirm Password *</label>
        <input
          type="password"
          id="confirmPassword"
          formControlName="confirmPassword"
          class="form-control"
          [class.is-invalid]="submitted && f['confirmPassword'].errors"
        />
        <div *ngIf="submitted && f['confirmPassword'].errors" class="invalid-feedback">
          <div *ngIf="f['confirmPassword'].errors?.['required']">Confirm Password is required</div>
          <div *ngIf="f['confirmPassword'].errors?.['mustMatch']">Passwords must match</div>
        </div>
      </div>
    </div>
  </div>

  <div class="mb-3">
    <div class="form-check">
      <input
        type="checkbox"
        id="isActive"
        formControlName="isActive"
        class="form-check-input"
      />
      <label for="isActive" class="form-check-label">Active Account</label>
    </div>
  </div>

  <div class="d-flex gap-2">
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="submitting"
    >
      <span *ngIf="submitting" class="spinner-border spinner-border-sm me-2"></span>
      {{ id ? 'Update' : 'Create' }} Account
    </button>
    <button type="button" class="btn btn-secondary" (click)="cancel()">Cancel</button>
  </div>
</form>
