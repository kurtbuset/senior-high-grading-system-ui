<div class="p-2">
  <h3>Accounts Management</h3>

  <!-- 🔍 Search Filter -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <button routerLink="add" class="btn btn-sml btn-primary">
      Add Account
    </button>

    <input
      type="text"
      class="form-control w-50"
      placeholder="Search by name, email, role, or status..."
      [(ngModel)]="searchTerm"
      (input)="applyFilter()"
    />
  </div>

  <table
    class="table table-hover table-sm text-center"
    *ngIf="!loading; else loadingTpl"
  >
    <thead>
      <tr>
        <th style="width: 5%">#</th>
        <th style="width: 20%">Name</th>
        <th style="width: 15%">Role</th>
        <th style="width: 10%">Status</th>
        <th style="width: 25%">Action</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let acc of paginatedAccounts; let i = index">
        <td>{{ acc.id }}</td>
        <td>{{ acc.firstName }} {{ acc.lastName }}</td>
        <td>
          <span
            class="badge"
            [ngClass]="{
              'bg-primary': acc.role === 'SuperAdmin',
              'bg-info text-dark': acc.role === 'Principal',
              'bg-warning text-dark': acc.role === 'Teacher',
              'bg-secondary': acc.role === 'Student',
              'bg-success': acc.role === 'Registrar'
            }"
          >
            {{ acc.role }}
          </span>
        </td>
        <td>
          <span
            class="badge"
            [ngClass]="{
              'bg-success': acc.isActive == 1,
              'bg-danger': acc.isActive == 0
            }"
          >
            {{ acc.isActive == 1 ? "Active" : "Inactive" }}
          </span>
        </td>
        <td>
          <button
            [routerLink]="['/accounts/edit', acc.id]"
            class="btn btn-sm btn-outline-primary me-1"
          >
            <i class="bi bi-pencil-square"></i> Edit
          </button>
          <button
            class="btn btn-sm btn-outline-success mx-2"
            [routerLink]="['/accounts/view', acc.id]"
          >
            <i class="bi bi-eye"></i> View
          </button>
          <button class="btn btn-sm btn-outline-danger" (click)="onDelete(acc)">
            <i class="bi bi-trash"></i> Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- 🔢 Pagination -->
  <div
    *ngIf="!loading && filteredAccounts.length > pageSize"
    class="d-flex justify-content-center mt-3"
  >
    <button
      class="btn btn-outline-secondary btn-sm me-2"
      [disabled]="currentPage === 1"
      (click)="prevPage()"
    >
      Previous
    </button>
    <span class="align-self-center"
      >Page {{ currentPage }} of {{ totalPages }}</span
    >
    <button
      class="btn btn-outline-secondary btn-sm ms-2"
      [disabled]="currentPage === totalPages"
      (click)="nextPage()"
    >
      Next
    </button>
  </div>

  <ng-template #loadingTpl>
    <div class="text-center p-3">Loading accounts...</div>
  </ng-template>
</div>
