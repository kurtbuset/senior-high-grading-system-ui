<!-- Edit Password - Simple Form Style -->
<div class="container-fluid py-4">
  <!-- Header Section -->
  <div class="mb-4">
    <h2 class="mb-0" style="color: #333; font-weight: 600;">Edit Password</h2>
    <p class="text-muted mt-2">Update your account password</p>
  </div>

  <!-- Form Section -->
  <div class="card" style="max-width: 500px;">
    <div class="card-body">
      <!-- Success Alert -->
      <div *ngIf="showSuccessAlert" class="alert alert-success alert-dismissible fade show mb-4" role="alert">
        <div class="d-flex align-items-center">
          <div class="me-3">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-check-circle-fill text-success" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.061L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
            </svg>
          </div>
          <div class="flex-grow-1">
            <h6 class="alert-heading mb-1">Password Changed Successfully!</h6>
            <p class="mb-0">Your password has been updated. Please click "Go to Login" to login with your new password.</p>
          </div>
        </div>
        <button type="button" class="btn-close" (click)="closeSuccessAlert()" aria-label="Close"></button>
      </div>
      
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <!-- Username Field (Read-only) -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Student ID</label>
          <input 
            type="text" 
            class="form-control" 
            value="2025-00001" 
            readonly 
            style="background-color: #f8f9fa;"
          />
          <small class="text-muted">This field is read-only</small>
        </div>

        <!-- Password Field -->
        <div class="mb-3">
          <label class="form-label fw-semibold">New Password <span class="text-danger">*</span></label>
          <input
            type="password"
            formControlName="password"
            class="form-control"
            placeholder="Enter new password"
            [ngClass]="{ 'is-invalid': submitted && f.password?.errors, 'is-valid': !submitted && f.password?.valid && f.password?.value }"
          />
          <div *ngIf="submitted && f.password?.errors" class="invalid-feedback">
            <div *ngIf="f.password?.errors['required']">Password is required</div>
            <div *ngIf="f.password?.errors['minlength']">Password must be at least 6 characters</div>
          </div>
          <small class="text-muted">Password must be at least 6 characters long</small>
        </div>

        <!-- Confirm Password Field -->
        <div class="mb-4">
          <label class="form-label fw-semibold">Confirm Password <span class="text-danger">*</span></label>
          <input
            type="password"
            formControlName="confirmPassword"
            class="form-control"
            placeholder="Confirm new password"
            [ngClass]="{ 'is-invalid': submitted && f.confirmPassword?.errors, 'is-valid': !submitted && f.confirmPassword?.valid && f.confirmPassword?.value && !f.confirmPassword?.errors }"
          />
          <div *ngIf="submitted && f.confirmPassword?.errors" class="invalid-feedback">
            <div *ngIf="f.confirmPassword?.errors['required']">Confirm password is required</div>
            <div *ngIf="f.confirmPassword?.errors['mustMatch']">Passwords must match</div>
          </div>
          <small class="text-muted">Re-enter your new password to confirm</small>
        </div>

        <!-- Buttons - Hide Save/Cancel after password change, show Go to Login -->
        <div class="d-flex gap-2 align-items-center">
          <!-- Save and Cancel buttons - only show before password change -->
          <button 
            *ngIf="!passwordChanged"
            [disabled]="loading" 
            type="submit" 
            class="btn btn-primary">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
            {{ loading ? 'Saving...' : 'Save Password' }}
          </button>
          <a *ngIf="!passwordChanged" routerLink="/profile" class="btn btn-secondary">Cancel</a>
          
          <!-- Go to Login button - only show after password change -->
          <button 
            *ngIf="passwordChanged" 
            type="button"
            class="btn btn-success"
            (click)="goToLogin()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-right me-2" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"/>
              <path fill-rule="evenodd" d="M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
            </svg>
            Go to Login
          </button>
        </div>
      </form>
    </div>
  </div>
</div>